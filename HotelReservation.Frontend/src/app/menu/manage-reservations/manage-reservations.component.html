<div class="grid">
    <div class="col-12">
        <div class="card px-6 py-6">
            <p-toast></p-toast>

            <div class="grid">
                <div class="col-12">
                    <div class="col-12">
                        <button
                            pButton
                            label="New Booking"
                            icon="pi pi-plus"
                            class="p-button-success mr-2"
                            (click)="create()"
                        ></button>
                        <!-- <button pButton label="Edit or Confirm" icon="pi pi-pencil" class="p-button-success mr-2"
                            (click)="edit(newReservation)"></button> -->
                        <!-- <button pButton pRipple label="Delete" icon="pi pi-trash" class="p-button-danger"
                            (click)="deleteSelected()">
                        </button> -->
                    </div>
                    <div
                        class="col-9 flex flex-column md:flex-row p-1 w-full gap-5"
                    >
                        <span class="block mt-2 md:mt-0 p-input-icon-left">
                            <i class="pi pi-search"></i>
                            <input
                                pInputText
                                type="text"
                                #filter
                                (input)="onGlobalFilter(dt1, $event)"
                                placeholder="Voucher No..."
                                class="w-full sm:w-auto"
                            />
                        </span>
                    </div>

                    <div class="col-12">
                        <p-table
                            #dt1
                            [value]="reservations"
                            [columns]="cols"
                            responsiveLayout="scroll"
                            styleClass="p-datatable-striped"
                            [rows]="10"
                            [globalFilterFields]="[
                                'id',
                                'agencyVoucherReference'
                            ]"
                            [rows]="10"
                            [paginator]="true"
                            [rowsPerPageOptions]="[10, 20, 30]"
                            [showCurrentPageReport]="true"
                            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                            selectionMode="multiple"
                            [rowHover]="true"
                            dataKey="id"
                        >
                            <ng-template pTemplate="caption">
                                <div
                                    class="flex flex-column md:flex-row md:justify-content-between md:align-items-center"
                                >
                                    <h5 class="m-0">Manage Bookings</h5>
                                </div>
                            </ng-template>
                            <ng-template pTemplate="header">
                                <tr style="height: 0.25rem; font-size: 12px">
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                            width: 3rem;
                                        "
                                    >
                                        <p-tableheadercheckbox></p-tableheadercheckbox>
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        Voucher No
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        Name
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        CheckIn Date
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        CheckOut Date
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        Total Amount
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                    >
                                        Booked By
                                    </th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-reservation>
                                <tr style="height: 0.25rem; font-size: 11px">
                                    <td>
                                        <p-tablecheckbox
                                            [value]="reservation"
                                        ></p-tablecheckbox>
                                    </td>
                                    <td style="width: 10%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >Voucher No</span
                                        >
                                        {{ reservation.id }}
                                    </td>
                                    <td style="width: 15%; min-width: 10rem">
                                        <span class="p-column-title">Name</span>
                                        {{ reservation.name }}
                                        {{ reservation.surname }}
                                    </td>
                                    <td style="width: 10%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >CheckIn</span
                                        >
                                        {{
                                            reservation.checkInDate
                                                | date : "MMMM d, y"
                                        }}
                                    </td>
                                    <td style="width: 10%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >CheckOut</span
                                        >
                                        {{
                                            reservation.checkOutDate
                                                | date : "MMMM d, y"
                                        }}
                                    </td>
                                    <td style="width: 5%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >Amount</span
                                        >
                                        {{ reservation.totalAmount | currency }}
                                    </td>
                                    <td>
                                        <div class="flex">
                                            <button
                                                pButton
                                                pRipple
                                                icon="pi pi-eye"
                                                class="p-button-rounded p-button-primary mr-2"
                                                (click)="view(reservation)"
                                            ></button>
                                            <button
                                                pButton
                                                pRipple
                                                icon="pi pi-pencil"
                                                class="p-button-rounded p-button-success mr-2"
                                                (click)="edit(reservation)"
                                            ></button>
                                            <!-- <button pButton pRipple icon="pi pi-trash"
                                                class="p-button-rounded p-button-danger"
                                                (click)="delete(reservation.id)"></button> -->
                                        </div>
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
                <!-------------------------------------------------create modal---------------------------------------->
                <p-dialog
                    [(visible)]="createBookingModal"
                    [style]="{ width: '90%' }"
                    header="New Booking"
                    [modal]="true"
                    class="p-fluid"
                >
                    <ng-template pTemplate="content">
                        <div class="formgrid grid">
                            <div
                                class="flex flex-column md:flex-row p-3 w-full"
                            >
                                <div class="field col-12">
                                    <p-tabview [(activeIndex)]="activeIndex">
                                        <!-- booking details -->
                                        <p-tabpanel header="Booking Details">
                                            <br />
                                            <br />
                                            <div class="formgrid grid">
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="text"
                                                                pInputText
                                                                id="firstname"
                                                                [(ngModel)]="
                                                                    newReservation.name
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.name
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.name
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >Customer First
                                                                Name</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="text"
                                                                pInputText
                                                                id="surname"
                                                                [disabled]="
                                                                    !newReservation.name
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.surname
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.surname
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.surname
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >Last
                                                                Name</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="email"
                                                                pInputText
                                                                id="email"
                                                                [disabled]="
                                                                    !newReservation.surname
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.phone
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.phone
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.phone
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >Phone</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="email"
                                                                pInputText
                                                                id="email"
                                                                [disabled]="
                                                                    !newReservation.phone
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.email
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.email
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.email
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >Email</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="text"
                                                                pInputText
                                                                id="id"
                                                                [disabled]="
                                                                    !newReservation.email
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.idNo
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.idNo
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.idNo
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >ID
                                                                Number</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <input
                                                                type="text"
                                                                pInputText
                                                                id="id"
                                                                [disabled]="
                                                                    !newReservation.idNo
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.address
                                                                "
                                                                required
                                                                autofocus
                                                                [ngClass]="{
                                                                    'ng-invalid ng-dirty':
                                                                        submitted &&
                                                                        !newReservation.address
                                                                }"
                                                            />
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.address
                                                                "
                                                                >Item name is
                                                                required.</small
                                                            >
                                                            <label for="name"
                                                                >Address</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <p-dropdown
                                                                appendTo="body"
                                                                [disabled]="
                                                                    !newReservation.address
                                                                "
                                                                [(ngModel)]="
                                                                    newReservation.country
                                                                "
                                                                [options]="
                                                                    countries
                                                                "
                                                                placeholder="Select Country"
                                                            >
                                                                <ng-template
                                                                    pTemplate="selectedCountry"
                                                                >
                                                                    <span
                                                                        *ngIf="
                                                                            newReservation &&
                                                                            newReservation.country
                                                                        "
                                                                        >{{
                                                                            newReservation.country
                                                                        }}
                                                                    </span>
                                                                </ng-template>
                                                                <ng-template
                                                                    let-option
                                                                    pTemplate="item"
                                                                >
                                                                    <span>{{
                                                                        option
                                                                    }}</span>
                                                                </ng-template>
                                                            </p-dropdown>
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.country
                                                                "
                                                            >
                                                                Item name is
                                                                required.
                                                            </small>
                                                            <label
                                                                for="country"
                                                            >
                                                                Nationality</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="field col-4">
                                                    <span class="p-float-label">
                                                        <p-calendar
                                                            appendTo="body"
                                                            [(ngModel)]="
                                                                newReservation.checkInDate
                                                            "
                                                            dateFormat="MM d, y"
                                                        ></p-calendar>
                                                        <small
                                                            class="ng-dirty ng-invalid"
                                                            *ngIf="
                                                                submitted &&
                                                                !newReservation.checkInDate
                                                            "
                                                            >Date is
                                                            required.</small
                                                        >
                                                        <label
                                                            for="creationTime"
                                                            >Check In
                                                            Date</label
                                                        >
                                                    </span>
                                                </div>
                                                <div class="field col-4">
                                                    <span class="p-float-label">
                                                        <p-calendar
                                                            appendTo="body"
                                                            [(ngModel)]="
                                                                newReservation.checkOutDate
                                                            "
                                                            dateFormat="MM d, y"
                                                        ></p-calendar>
                                                        <small
                                                            class="ng-dirty ng-invalid"
                                                            *ngIf="
                                                                submitted &&
                                                                !newReservation.checkOutDate
                                                            "
                                                            >Date is
                                                            required.</small
                                                        >
                                                        <label
                                                            for="creationTime"
                                                            >Check Out
                                                            Date</label
                                                        >
                                                    </span>
                                                </div>
                                            </div>
                                        </p-tabpanel>

                                        <!-- Product details -->
                                        <p-tabpanel
                                            header="Product Details"
                                            [disabled]="
                                                !newReservation.checkOutDate
                                            "
                                        >
                                            <br />
                                            <br />
                                            <div class="formgrid grid">
                                                <div class="field col-6">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <p-dropdown
                                                                appendTo="body"
                                                                [(ngModel)]="
                                                                    newReservationProduct.roomType
                                                                "
                                                                [options]="
                                                                    roomTypes
                                                                "
                                                                placeholder="Select Room Type"
                                                            >
                                                                <ng-template
                                                                    pTemplate="selectedRoomType"
                                                                >
                                                                    <span
                                                                        *ngIf="
                                                                            newReservationProduct &&
                                                                            newReservationProduct.roomType
                                                                        "
                                                                        >{{
                                                                            newReservationProduct.roomType
                                                                        }}
                                                                    </span>
                                                                </ng-template>
                                                                <ng-template
                                                                    let-option
                                                                    pTemplate="item"
                                                                >
                                                                    <span>{{
                                                                        option
                                                                    }}</span>
                                                                </ng-template>
                                                            </p-dropdown>
                                                            <small
                                                                class="ng-dirty ng-invalid"
                                                                style="
                                                                    color: red;
                                                                "
                                                                *ngIf="
                                                                    submitted &&
                                                                    !newReservation.country
                                                                "
                                                            >
                                                                Item name is
                                                                required.
                                                            </small>
                                                            <label
                                                                for="country"
                                                            >
                                                                Room Type</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <br />
                                                <div class="field col-6">
                                                    <div class="field">
                                                        <span
                                                            class="p-float-label"
                                                        >
                                                            <p-dropdown
                                                                appendTo="body"
                                                                [disabled]="
                                                                    !newReservationProduct.roomType
                                                                "
                                                                [(ngModel)]="
                                                                    newReservationProduct.roomNo
                                                                "
                                                                inputId="id"
                                                                [showClear]="
                                                                    true
                                                                "
                                                                [options]="
                                                                    rooms
                                                                "
                                                                placeholder="Select Room No"
                                                                optionLabel="id"
                                                            >
                                                            </p-dropdown>
                                                            <label for="room"
                                                                >Room No</label
                                                            >
                                                        </span>
                                                    </div>
                                                </div>
                                                <br />
                                                <div class="field col-6">
                                                    <span class="p-float-label">
                                                        <input
                                                            type="number"
                                                            pInputText
                                                            id="name"
                                                            [disabled]="
                                                                !newReservationProduct.roomNo
                                                            "
                                                            [(ngModel)]="
                                                                newReservationProduct.adultPax
                                                            "
                                                            required
                                                            autofocus
                                                            [ngClass]="{
                                                                'ng-invalid ng-dirty':
                                                                    submitted &&
                                                                    !newReservationProduct.adultPax
                                                            }"
                                                        />
                                                        <small
                                                            class="ng-dirty ng-invalid"
                                                            style="color: red"
                                                            *ngIf="
                                                                submitted &&
                                                                !newReservationProduct.adultPax
                                                            "
                                                            >Item name is
                                                            required.</small
                                                        >
                                                        <label
                                                            for="name"
                                                            *ngIf="
                                                                productType !==
                                                                'Accommodation'
                                                            "
                                                            >Adult Pax</label
                                                        >
                                                    </span>
                                                </div>
                                                <div class="field col-6">
                                                    <span class="p-float-label">
                                                        <input
                                                            type="number"
                                                            pInputText
                                                            id="name"
                                                            [disabled]="
                                                                !newReservationProduct.roomNo
                                                            "
                                                            [(ngModel)]="
                                                                newReservationProduct.childPax
                                                            "
                                                            required
                                                            autofocus
                                                            [ngClass]="{
                                                                'ng-invalid ng-dirty':
                                                                    submitted &&
                                                                    !newReservationProduct.childPax
                                                            }"
                                                        />
                                                        <small
                                                            class="ng-dirty ng-invalid"
                                                            style="color: red"
                                                            *ngIf="
                                                                submitted &&
                                                                !newReservationProduct.childPax
                                                            "
                                                            >Item name is
                                                            required.</small
                                                        >
                                                        <label
                                                            for="name"
                                                            *ngIf="
                                                                productType !==
                                                                'Accommodation'
                                                            "
                                                            >Child Pax</label
                                                        >
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="formgrid grid">
                                                <div
                                                    class="flex flex-column md:flex-row p-3 w-full"
                                                >
                                                    <div class="field col-12">
                                                        <p-fieldset
                                                            legend="Products"
                                                        >
                                                            <p-table
                                                                dataKey="productName"
                                                                [value]="
                                                                    newReservation.reservationProducts!
                                                                "
                                                                [expandedRowKeys]="
                                                                    expandedRows
                                                                "
                                                                responsiveLayout="scroll"
                                                                [(selection)]="
                                                                    selectedReservationProducts
                                                                "
                                                                selectionMode="multiple"
                                                                [scrollable]="
                                                                    true
                                                                "
                                                            >
                                                                <!-- reservation products table head -->
                                                                <ng-template
                                                                    pTemplate="header"
                                                                >
                                                                    <tr
                                                                        style="
                                                                            height: 0.25rem;
                                                                            font-size: 11px;
                                                                        "
                                                                    >
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="name"
                                                                            colspan="3"
                                                                        >
                                                                            Room
                                                                            Type
                                                                        </th>
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="cell"
                                                                        >
                                                                            Room
                                                                            No
                                                                        </th>
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="email"
                                                                            colspan="2"
                                                                        >
                                                                            Adult
                                                                            Pax
                                                                        </th>
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="country"
                                                                        >
                                                                            Child
                                                                            Pax
                                                                        </th>
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="country"
                                                                            colspan="2"
                                                                        >
                                                                            Unit
                                                                            Cost
                                                                        </th>
                                                                        <th
                                                                            style="
                                                                                font-size: larger;
                                                                                background-color: grey;
                                                                                color: white;
                                                                            "
                                                                            pSortableColumn="country"
                                                                        >
                                                                            Total
                                                                            Amount
                                                                        </th>
                                                                        <!-- <th></th> -->
                                                                    </tr>
                                                                </ng-template>
                                                                <!-- reservation products table body -->
                                                                <ng-template
                                                                    pTemplate="body"
                                                                    let-product
                                                                    let-expanded="expanded"
                                                                >
                                                                    <tr
                                                                        style="
                                                                            height: 0.25rem;
                                                                            font-size: 11px;
                                                                        "
                                                                    >
                                                                        <td>
                                                                            <p-tablecheckbox
                                                                                [value]="
                                                                                    product
                                                                                "
                                                                            ></p-tablecheckbox>
                                                                        </td>
                                                                        <td>
                                                                            <p-button
                                                                                type="button"
                                                                                pRipple
                                                                                [pRowToggler]="
                                                                                    product
                                                                                "
                                                                                [text]="
                                                                                    true
                                                                                "
                                                                                [rounded]="
                                                                                    true
                                                                                "
                                                                                [plain]="
                                                                                    true
                                                                                "
                                                                                [icon]="
                                                                                    expanded
                                                                                        ? 'pi pi-chevron-down'
                                                                                        : 'pi pi-chevron-right'
                                                                                "
                                                                                *ngIf="
                                                                                    product.productType ===
                                                                                    'Combo'
                                                                                "
                                                                            />
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 30%;
                                                                                min-width: 10rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >RRoom
                                                                                Type</span
                                                                            >
                                                                            {{
                                                                                product.roomType
                                                                            }}
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 5%;
                                                                                min-width: 10rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >Room</span
                                                                            >
                                                                            {{
                                                                                product.roomNo
                                                                            }}
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 5%;
                                                                                min-width: 10rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >Adult
                                                                                Pax</span
                                                                            >
                                                                            {{
                                                                                product.adultPax
                                                                            }}
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 5%;
                                                                                min-width: 10rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >child</span
                                                                            >
                                                                            {{
                                                                                product.childPax
                                                                            }}
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 5%;
                                                                                min-width: 8rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >Unit
                                                                                Cost</span
                                                                            >
                                                                            {{
                                                                                product.unitCost
                                                                                    | currency
                                                                            }}
                                                                        </td>
                                                                        <td
                                                                            style="
                                                                                width: 10%;
                                                                                min-width: 10rem;
                                                                            "
                                                                        >
                                                                            <span
                                                                                class="p-column-title"
                                                                                >Total
                                                                                Amount</span
                                                                            >
                                                                            {{
                                                                                product.totalAmount
                                                                                    | currency
                                                                            }}
                                                                        </td>
                                                                    </tr>
                                                                </ng-template>
                                                            </p-table>
                                                            <!-- reservation products table totals -->
                                                            <div class="field">
                                                                <div
                                                                    class="formgrid grid"
                                                                >
                                                                    <div
                                                                        class="col-8"
                                                                    ></div>
                                                                    <div
                                                                        class="col-4"
                                                                    >
                                                                        <p-table>
                                                                            <ng-template
                                                                                pTemplate="header"
                                                                            >
                                                                                <tr>
                                                                                    <td
                                                                                        style="
                                                                                            width: 60%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        Total
                                                                                        Deposits
                                                                                    </td>
                                                                                    <td
                                                                                        style="
                                                                                            width: 40%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        {{
                                                                                            totalDeposits
                                                                                                | currency
                                                                                        }}
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td
                                                                                        style="
                                                                                            width: 60%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        SUB
                                                                                        TOTAL
                                                                                        USD:
                                                                                    </td>
                                                                                    <td
                                                                                        style="
                                                                                            width: 40%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        {{
                                                                                            totalExcludingVat
                                                                                                | currency
                                                                                                    : "USD"
                                                                                        }}
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td
                                                                                        style="
                                                                                            width: 60%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        VAT:
                                                                                    </td>
                                                                                    <td
                                                                                        style="
                                                                                            width: 40%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        {{
                                                                                            newReservation.vat
                                                                                                | currency
                                                                                                    : "USD"
                                                                                        }}
                                                                                    </td>
                                                                                </tr>
                                                                                <tr>
                                                                                    <td
                                                                                        style="
                                                                                            width: 60%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        Total
                                                                                        USD:
                                                                                    </td>
                                                                                    <td
                                                                                        style="
                                                                                            width: 40%;
                                                                                            min-width: 10rem;
                                                                                        "
                                                                                    >
                                                                                        {{
                                                                                            newReservation.totalAmount
                                                                                                | currency
                                                                                                    : "USD"
                                                                                        }}
                                                                                    </td>
                                                                                </tr>
                                                                            </ng-template>
                                                                        </p-table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </p-fieldset>
                                                    </div>
                                                </div>
                                            </div>
                                        </p-tabpanel>

                                        <!-- Payment details -->
                                        <p-tabpanel header="Payment Details">
                                            <br />
                                            <div class="formgrid grid">
                                                <div
                                                    class="field col-3"
                                                    style="font-size: 11px"
                                                >
                                                    <div class="formgrid grid">
                                                        <div
                                                            class="field col-6"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >Method Of
                                                                    Pay</label
                                                                >
                                                                <span
                                                                    class="p-float-label"
                                                                >
                                                                    <p-dropdown
                                                                        appendTo="body"
                                                                        [filter]="
                                                                            true
                                                                        "
                                                                        filterBy="name"
                                                                        [showClear]="
                                                                            true
                                                                        "
                                                                        [(ngModel)]="
                                                                            payment.methodOfPay
                                                                        "
                                                                        inputId="id"
                                                                        [options]="
                                                                            methodOfPayments
                                                                        "
                                                                        placeholder="Select Payment Method"
                                                                    >
                                                                    </p-dropdown>
                                                                </span>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="field col-6"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >Amount
                                                                    Paid</label
                                                                >
                                                                <input
                                                                    type="number"
                                                                    pInputText
                                                                    id="name"
                                                                    (input)="
                                                                        calculateDifference()
                                                                    "
                                                                    [disabled]="
                                                                        payment.methodOfPay ===
                                                                            'BankDeposit' ||
                                                                        !payment.currency
                                                                    "
                                                                    [(ngModel)]="
                                                                        payment.amount
                                                                    "
                                                                    required
                                                                    autofocus
                                                                    placeholder="$0.00"
                                                                    [ngClass]="{
                                                                        'ng-invalid ng-dirty':
                                                                            submitted &&
                                                                            !payment.amount
                                                                    }"
                                                                />
                                                                <small
                                                                    class="ng-dirty ng-invalid"
                                                                    style="
                                                                        color: red;
                                                                    "
                                                                    *ngIf="
                                                                        submitted &&
                                                                        !payment.amount
                                                                    "
                                                                    >Item name
                                                                    is required.
                                                                </small>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="field col-6"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >Bank</label
                                                                >
                                                                <input
                                                                    type="currency"
                                                                    pInputText
                                                                    id="name"
                                                                    [disabled]="
                                                                        payment.methodOfPay !==
                                                                        'CreditCard'
                                                                    "
                                                                    [(ngModel)]="
                                                                        payment.bank
                                                                    "
                                                                    required
                                                                    autofocus
                                                                    placeholder="bank"
                                                                    [ngClass]="{
                                                                        'ng-invalid ng-dirty':
                                                                            submitted &&
                                                                            !payment.bank
                                                                    }"
                                                                />
                                                                <small
                                                                    class="ng-dirty ng-invalid"
                                                                    style="
                                                                        color: red;
                                                                    "
                                                                    *ngIf="
                                                                        submitted &&
                                                                        !payment.bank
                                                                    "
                                                                    >Item name
                                                                    is required.
                                                                </small>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="field col-6"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >Card
                                                                    Number</label
                                                                >
                                                                <input
                                                                    type="number"
                                                                    pInputText
                                                                    id="name"
                                                                    [disabled]="
                                                                        payment.methodOfPay !==
                                                                        'CreditCard'
                                                                    "
                                                                    [(ngModel)]="
                                                                        payment.cardNo
                                                                    "
                                                                    required
                                                                    autofocus
                                                                    placeholder="0000 0000 0000 0000"
                                                                    [ngClass]="{
                                                                        'ng-invalid ng-dirty':
                                                                            submitted &&
                                                                            !payment.cardNo
                                                                    }"
                                                                />
                                                                <small
                                                                    class="ng-dirty ng-invalid"
                                                                    style="
                                                                        color: red;
                                                                    "
                                                                    *ngIf="
                                                                        submitted &&
                                                                        !payment.cardNo
                                                                    "
                                                                    >Item name
                                                                    is required.
                                                                </small>
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="field col-6"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >POS
                                                                    Machine</label
                                                                >
                                                                <span
                                                                    class="p-float-label"
                                                                >
                                                                    <p-dropdown
                                                                        appendTo="body"
                                                                        optionLabel="machineName"
                                                                        [filter]="
                                                                            true
                                                                        "
                                                                        filterBy="name"
                                                                        [showClear]="
                                                                            true
                                                                        "
                                                                        inputId="id"
                                                                        [options]="
                                                                            posMachines
                                                                        "
                                                                        [(ngModel)]="
                                                                            payment.creditCardMachine
                                                                        "
                                                                        placeholder="Select Currency"
                                                                        [disabled]="
                                                                            payment.methodOfPay !==
                                                                            'CreditCard'
                                                                        "
                                                                    >
                                                                    </p-dropdown>
                                                                </span>
                                                            </div>
                                                        </div>

                                                        <div
                                                            class="field col-12"
                                                        >
                                                            <div class="field">
                                                                <label
                                                                    for="currency"
                                                                    >New
                                                                    Payment</label
                                                                >
                                                                <p-button
                                                                    label="Add Payment"
                                                                    icon="pi pi-check"
                                                                    styleClass="p-button-success"
                                                                    (click)="
                                                                        createPayment()
                                                                    "
                                                                    [disabled]="
                                                                        !payment.amount
                                                                    "
                                                                ></p-button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="field col-1">
                                                    <p-divider
                                                        layout="vertical"
                                                    ></p-divider>
                                                </div>
                                                <div
                                                    class="field col-8"
                                                    style="font-size: 12px"
                                                >
                                                    <div class="formgrid grid">
                                                        <div
                                                            class="flex flex-column md:flex-row p-3 w-full"
                                                        >
                                                            <div
                                                                class="field col-12"
                                                            >
                                                                <p-table
                                                                    [value]="
                                                                        newReservation.payments!
                                                                    "
                                                                    dataKey="name"
                                                                    responsiveLayout="scroll"
                                                                    [(selection)]="
                                                                        selectedReservationProducts
                                                                    "
                                                                    selectionMode="multiple"
                                                                    [scrollable]="
                                                                        true
                                                                    "
                                                                >
                                                                    <ng-template
                                                                        pTemplate="header"
                                                                    >
                                                                        <tr
                                                                            style="
                                                                                height: 0.25rem;
                                                                                font-size: 12px;
                                                                            "
                                                                        >
                                                                            <th
                                                                                style="
                                                                                    width: 3rem;
                                                                                "
                                                                            >
                                                                                <p-tableheadercheckbox></p-tableheadercheckbox>
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="name"
                                                                            >
                                                                                Method
                                                                                Of
                                                                                Pay
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="name"
                                                                            >
                                                                                Currency
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="name"
                                                                            >
                                                                                Bank
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="cell"
                                                                            >
                                                                                Card
                                                                                N#
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="email"
                                                                            >
                                                                                Date
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="country"
                                                                            >
                                                                                Deposit
                                                                                Date
                                                                            </th>
                                                                            <th
                                                                                pSortableColumn="name"
                                                                            >
                                                                                Amount
                                                                            </th>
                                                                            <!-- <th></th> -->
                                                                        </tr>
                                                                    </ng-template>
                                                                    <ng-template
                                                                        pTemplate="body"
                                                                        let-payment
                                                                        let-expanded="expanded"
                                                                    >
                                                                        <tr
                                                                            style="
                                                                                height: 0.25rem;
                                                                                font-size: 11px;
                                                                            "
                                                                        >
                                                                            <td>
                                                                                <p-tablecheckbox
                                                                                    [value]="
                                                                                        payment
                                                                                    "
                                                                                ></p-tablecheckbox>
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 20%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Name</span
                                                                                >
                                                                                {{
                                                                                    payment.methodOfPay
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 15%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Phone</span
                                                                                >
                                                                                {{
                                                                                    payment.currencyId
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 15%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Name</span
                                                                                >
                                                                                {{
                                                                                    payment.bank
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 15%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Phone</span
                                                                                >
                                                                                {{
                                                                                    payment.cardNo
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 5%;
                                                                                    min-width: 8rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Email</span
                                                                                >
                                                                                {{
                                                                                    payment.creationTime
                                                                                        | date
                                                                                            : " d MMM y"
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 10%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Country</span
                                                                                >
                                                                                {{
                                                                                    payment.bank
                                                                                        | date
                                                                                            : "MMMM d, y"
                                                                                }}
                                                                            </td>
                                                                            <td
                                                                                style="
                                                                                    width: 10%;
                                                                                    min-width: 10rem;
                                                                                "
                                                                            >
                                                                                <span
                                                                                    class="p-column-title"
                                                                                    >Country</span
                                                                                >
                                                                                {{
                                                                                    payment.amount
                                                                                        | currency
                                                                                }}
                                                                            </td>
                                                                        </tr>
                                                                    </ng-template>
                                                                </p-table>
                                                                <div
                                                                    class="field"
                                                                >
                                                                    <div
                                                                        class="formgrid grid"
                                                                    >
                                                                        <div
                                                                            class="col-8"
                                                                        ></div>
                                                                        <div
                                                                            class="col-4"
                                                                        >
                                                                            <p-table>
                                                                                <ng-template
                                                                                    pTemplate="header"
                                                                                >
                                                                                    <tr>
                                                                                        <td>
                                                                                            Sub
                                                                                            Total
                                                                                            Amount:
                                                                                        </td>
                                                                                        <td>
                                                                                            {{
                                                                                                subTotalAmountPaid
                                                                                                    | currency
                                                                                                        : "USD"
                                                                                            }}
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Discount:
                                                                                        </td>
                                                                                        <td>
                                                                                            {{
                                                                                                discount
                                                                                                    | currency
                                                                                                        : "USD"
                                                                                            }}
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Vat:
                                                                                        </td>
                                                                                        <td>
                                                                                            {{
                                                                                                vat
                                                                                                    | currency
                                                                                                        : "USD"
                                                                                            }}
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Toatal
                                                                                            Amount:
                                                                                        </td>
                                                                                        <td>
                                                                                            {{
                                                                                                totalAmountPaid
                                                                                                    | currency
                                                                                                        : "USD"
                                                                                            }}
                                                                                        </td>
                                                                                    </tr>
                                                                                </ng-template>
                                                                            </p-table>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </p-tabpanel>
                                    </p-tabview>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="footer">
                        <p-button
                            label="Save"
                            icon="pi pi-check-circle"
                            styleClass="p-button-success"
                            [disabled]="!newReservation.checkOutDate"
                            (click)="Save()"
                        ></p-button>
                        <p-button
                            label="Refresh"
                            icon="pi pi-replay"
                            styleClass="p-button-primary"
                            (click)="hideDialog()"
                        ></p-button>
                    </ng-template>
                </p-dialog>

                <!-------------------------------------------------Edit Booking Modal----------------------------------->

                <!-------------------------------------------------View Booking Modal----------------------------------->
                <p-dialog
                    [(visible)]="viewBookingModal"
                    [style]="{ width: '1200px', height: '550px' }"
                    [modal]="true"
                    class="p-fluid"
                >
                    <p-fieldset legend="View Booking">
                        <ng-template pTemplate="content">
                            <div class="formgrid grid" style="font-size: 14px">
                                <div class="field col-4">
                                    <h4>Firstname:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.name }}
                                    </p>
                                    <hr />
                                    <h4>Email:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.email }}
                                    </p>
                                    <hr />
                                    <h4>Nationality:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.country }}
                                    </p>
                                    <hr />
                                </div>
                                <div class="field col-4">
                                    <h4>Last Name:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.surname }}
                                    </p>
                                    <hr />
                                    <h4>ID Number:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.idNo }}
                                    </p>
                                    <hr />
                                    <h4>CheckIn Date:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.checkInDate | date : "MMMM d, y" }}
                                    </p>
                                    <hr />
                                </div>
                                <div class="field col-4">
                                    <h4>Phone:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.phone }}
                                    </p>
                                    <hr />
                                    <h4>Address:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.address }}
                                    </p>
                                    <hr />
                                    <h4>Check Out Date:</h4>
                                    <p style="color: rgb(5, 5, 95)">
                                        {{ selectedReservation.checkOutDate | date : "MMMM d, y" }}
                                    </p>
                                    <hr />
                                </div>
                            </div>
                        </ng-template>
                    </p-fieldset>
                    <br />
                    <br />
                    <p-fieldset legend="Products">
                        <p-table
                            [value]="selectedReservation.reservationProduct!"
                            dataKey="id"
                            styleClass="p-datatable-striped"
                            [tableStyle]="{ 'min-width': '60rem' }"
                            responsiveLayout="scroll"
                            [(selection)]="selectedReservationProducts"
                            selectionMode="multiple"
                            [scrollable]="true"
                        >
                            <ng-template pTemplate="header">
                                <tr style="height: 0.25rem; font-size: 11px">
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="name"
                                        colspan="3"
                                    >
                                        Room Type
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="cell"
                                    >
                                        Room No
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="email"
                                        colspan="2"
                                    >
                                        Adult Pax
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="country"
                                    >
                                        Child Pax
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="country"
                                        colspan="2"
                                    >
                                        Unit Cost
                                    </th>
                                    <th
                                        style="
                                            font-size: larger;
                                            background-color: grey;
                                            color: white;
                                        "
                                        pSortableColumn="country"
                                    >
                                        Total Amount
                                    </th>
                                    <!-- <th></th> -->
                                </tr>
                            </ng-template>
                            <!-- reservation products table body -->
                            <ng-template
                                pTemplate="body"
                                let-product
                                let-expanded="expanded"
                            >
                                <tr style="height: 0.25rem; font-size: 11px">
                                    <td>
                                        <p-tablecheckbox
                                            [value]="product"
                                        ></p-tablecheckbox>
                                    </td>
                                    <td>
                                        <p-button
                                            type="button"
                                            pRipple
                                            [pRowToggler]="product"
                                            [text]="true"
                                            [rounded]="true"
                                            [plain]="true"
                                            [icon]="
                                                expanded
                                                    ? 'pi pi-chevron-down'
                                                    : 'pi pi-chevron-right'
                                            "
                                            *ngIf="
                                                product.productType === 'Combo'
                                            "
                                        />
                                    </td>
                                    <td style="width: 30%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >RRoom Type</span
                                        >
                                        {{ product.roomType }}
                                    </td>
                                    <td style="width: 5%; min-width: 10rem">
                                        <span class="p-column-title">Room</span>
                                        {{ product.roomNo }}
                                    </td>
                                    <td style="width: 5%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >Adult Pax</span
                                        >
                                        {{ product.adultPax }}
                                    </td>
                                    <td style="width: 5%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >child</span
                                        >
                                        {{ product.childPax }}
                                    </td>
                                    <td style="width: 5%; min-width: 8rem">
                                        <span class="p-column-title"
                                            >Unit Cost</span
                                        >
                                        {{ product.unitCost | currency }}
                                    </td>
                                    <td style="width: 10%; min-width: 10rem">
                                        <span class="p-column-title"
                                            >Total Amount</span
                                        >
                                        {{ product.totalAmount | currency }}
                                    </td>
                                </tr>
                            </ng-template>
                        </p-table>
                        <div class="field">
                            <div class="formgrid grid">
                                <div class="col-11"></div>
                                <div class="col-1">
                                    <p-table>
                                        <ng-template pTemplate="header">
                                            <tr>
                                                <td>USD:</td>
                                                <td>
                                                    {{
                                                        selectedReservation.amount
                                                            | currency : "USD"
                                                    }}
                                                </td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                </div>
                            </div>
                        </div>
                    </p-fieldset>
                </p-dialog>
                <!-------------------------------------------------Supervisor Booking Modal----------------------------------->

                <!-------------------------------------------------Delete Selected Reservation Product Modal----------------------------------->

                <!-------------------------------------------------Delete Selected Reservation Product Modal----------------------------------->

                <!------------------------------------------------- Add TripAccount modal ---------------------------------------------------->
            </div>
        </div>
    </div>
</div>
